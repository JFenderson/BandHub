generator client {
  provider        = "prisma-client-js"
  output          = "../../../node_modules/.prisma/client"
  previewFeatures = ["fullTextSearch"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Band {
  id                 String              @id @default(cuid())
  name               String
  slug               String              @unique
  schoolName         String              @map("school_name")
  city               String
  state              String
  conference         String?
  logoUrl            String?             @map("logo_url")
  bannerUrl          String?             @map("banner_url")
  description        String?
  foundedYear        Int?                @map("founded_year")
  youtubeChannelId   String?             @map("youtube_channel_id")
  youtubePlaylistIds String[]            @map("youtube_playlist_ids")
  lastSyncAt         DateTime?           @map("last_sync_at")
  syncStatus         SyncStatus          @default(PENDING) @map("sync_status")
  isActive           Boolean             @default(true) @map("is_active")
  isFeatured         Boolean             @default(false) @map("is_featured")
  createdAt          DateTime            @default(now()) @map("created_at")
  updatedAt          DateTime            @updatedAt @map("updated_at")
  searchKeywords     String[]            @default([]) @map("search_keywords")
  featuredOrder      Int?                @map("featured_order")
  featuredSince      DateTime?           @map("featured_since")
  earliestVideoDate  DateTime?           @map("earliest_video_date")
  firstSyncedAt      DateTime?           @map("first_synced_at")
  lastFullSync       DateTime?           @map("last_full_sync")
  latestVideoDate    DateTime?           @map("latest_video_date")
  totalVideoCount    Int                 @default(0) @map("total_video_count")
  followers          FavoriteBand[]
  featuredClicks     FeaturedBandClick[]
  quotaUsageLogs     QuotaUsageLog[]
  syncJobs           SyncJob[]
  videos             Video[]             @relation("BandVideos")
  opponentVideos     Video[]             @relation("OpponentBandVideos")
  youtubeVideos      YouTubeVideo[]

  @@index([slug])
  @@index([schoolName])
  @@index([state])
  @@index([conference])
  @@index([isActive, isFeatured])
  @@index([featuredOrder])
  @@index([youtubeChannelId])
  @@index([state, conference])
  @@index([isActive, state])
  @@index([isFeatured, featuredOrder])
  @@map("bands")
}

model ContentCreator {
  id               String         @id @default(cuid())
  name             String
  youtubeChannelId String         @unique
  channelUrl       String
  description      String?
  logoUrl          String?
  thumbnailUrl     String?
  subscriberCount  Int            @default(0)
  totalVideoCount  Int            @default(0)
  videosInOurDb    Int            @default(0)
  isVerified       Boolean        @default(false)
  isFeatured       Boolean        @default(false)
  qualityScore     Int            @default(0)
  lastSyncedAt     DateTime?
  firstSyncedAt    DateTime?
  lastFullSync     DateTime?
  createdAt        DateTime       @default(now())
  updatedAt        DateTime       @updatedAt
  videos           Video[]
  youtubeVideos    YouTubeVideo[]

  @@index([youtubeChannelId])
  @@index([isFeatured, qualityScore(sort: Desc)])
  @@index([isFeatured])
  @@index([isVerified])
  @@index([qualityScore])
  @@index([createdAt])
  @@map("content_creators")
}

model YouTubeVideo {
  id           String          @id @default(cuid())
  youtubeId    String          @unique @map("youtube_id")
  title        String
  description  String?
  thumbnailUrl String          @map("thumbnail_url")
  url          String
  duration     Int             @default(0)
  publishedAt  DateTime        @map("published_at")
  viewCount    Int             @default(0) @map("view_count")
  likeCount    Int             @default(0) @map("like_count")
  channelId    String          @map("channel_id")
  channelTitle String?         @map("channel_title")
  bandId       String?         @map("band_id")
  creatorId    String?         @map("creator_id")
  syncStatus   SyncStatus      @default(PENDING) @map("sync_status")
  lastSyncedAt DateTime?       @map("last_synced_at")
  syncErrors   String[]        @default([]) @map("sync_errors")
  isPromoted   Boolean         @default(false) @map("is_promoted")
  promotedAt   DateTime?       @map("promoted_at")
  qualityScore Int             @default(0) @map("quality_score")
  createdAt    DateTime        @default(now()) @map("created_at")
  updatedAt    DateTime        @updatedAt @map("updated_at")
  band         Band?           @relation(fields: [bandId], references: [id])
  creator      ContentCreator? @relation(fields: [creatorId], references: [id])

  @@index([bandId])
  @@index([creatorId])
  @@index([publishedAt(sort: Desc)])
  @@index([viewCount(sort: Desc)])
  @@index([bandId, publishedAt(sort: Desc)])
  @@index([creatorId, publishedAt(sort: Desc)])
  @@index([channelId])
  @@index([syncStatus])
  @@index([isPromoted])
  @@index([channelId, syncStatus])
  @@index([channelId, lastSyncedAt])
  @@index([syncStatus, createdAt])
  @@index([qualityScore(sort: Desc)])
  @@map("youtube_videos")
}

model Video {
  id             String          @id @default(cuid())
  youtubeId      String          @unique @map("youtube_id")
  title          String
  description    String?
  thumbnailUrl   String          @map("thumbnail_url")
  duration       Int
  publishedAt    DateTime        @map("published_at")
  viewCount      Int             @default(0) @map("view_count")
  likeCount      Int             @default(0) @map("like_count")
  eventName      String?         @map("event_name")
  eventYear      Int?            @map("event_year")
  tags           String[]        @default([])
  isHidden       Boolean         @default(false) @map("is_hidden")
  hideReason     String?         @map("hide_reason")
  qualityScore   Int             @default(0) @map("quality_score")
  createdAt      DateTime        @default(now()) @map("created_at")
  updatedAt      DateTime        @updatedAt @map("updated_at")
  bandId         String          @map("band_id")
  opponentBandId String?         @map("opponent_band_id")
  categoryId     String?         @map("category_id")
  creatorId      String?
  favorites      FavoriteVideo[]
  band           Band            @relation("BandVideos", fields: [bandId], references: [id], onDelete: Cascade)
  category       Category?       @relation(fields: [categoryId], references: [id])
  creator        ContentCreator? @relation(fields: [creatorId], references: [id])
  opponentBand   Band?           @relation("OpponentBandVideos", fields: [opponentBandId], references: [id])
  watchLater     WatchLater[]

  @@index([bandId])
  @@index([opponentBandId])
  @@index([categoryId])
  @@index([eventYear])
  @@index([publishedAt(sort: Desc)])
  @@index([viewCount(sort: Desc)])
  @@index([isHidden])
  @@index([bandId, categoryId])
  @@index([bandId, eventYear])
  @@index([title])
  @@index([creatorId])
  @@index([isHidden, publishedAt(sort: Desc)])
  @@index([bandId, isHidden, publishedAt(sort: Desc)])
  @@index([categoryId, isHidden, publishedAt(sort: Desc)])
  @@index([bandId, categoryId, isHidden])
  @@index([eventYear, isHidden])
  @@index([opponentBandId, isHidden])
  @@index([duration])
  @@index([qualityScore(sort: Desc)])
  @@index([bandId, viewCount(sort: Desc)])
  @@map("videos")
}

model Category {
  id          String   @id @default(cuid())
  name        String   @unique
  slug        String   @unique
  description String?
  sortOrder   Int      @default(0) @map("sort_order")
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")
  videos      Video[]

  @@index([slug])
  @@index([sortOrder])
  @@map("categories")
}

model Event {
  id          String       @id @default(cuid())
  name        String
  slug        String       @unique
  description String?
  eventType   EventType    @map("event_type")
  eventDate   DateTime     @map("event_date")
  endDate     DateTime?    @map("end_date")
  location    String?
  venue       String?
  city        String?
  state       String?
  year        Int
  isRecurring Boolean      @default(false) @map("is_recurring")
  isActive    Boolean      @default(true) @map("is_active")
  imageUrl    String?      @map("image_url")
  createdAt   DateTime     @default(now()) @map("created_at")
  updatedAt   DateTime     @updatedAt @map("updated_at")
  eventBands  EventBand[]
  eventVideos EventVideo[]

  @@index([slug])
  @@index([eventType])
  @@index([eventDate])
  @@index([isActive, year])
  @@index([year])
  @@index([isActive])
  @@map("events")
}

model EventVideo {
  id        String   @id @default(cuid())
  eventId   String   @map("event_id")
  videoId   String   @map("video_id")
  createdAt DateTime @default(now()) @map("created_at")
  event     Event    @relation(fields: [eventId], references: [id], onDelete: Cascade)

  @@unique([eventId, videoId])
  @@index([eventId])
  @@index([videoId])
  @@map("event_videos")
}

model EventBand {
  id        String   @id @default(cuid())
  eventId   String   @map("event_id")
  bandId    String   @map("band_id")
  role      String?
  createdAt DateTime @default(now()) @map("created_at")
  event     Event    @relation(fields: [eventId], references: [id], onDelete: Cascade)

  @@unique([eventId, bandId])
  @@index([eventId])
  @@index([bandId])
  @@map("event_bands")
}

model AdminUser {
  id                       String                    @id @default(uuid())
  email                    String                    @unique
  passwordHash             String                    @map("password_hash")
  name                     String
  lastLoginAt              DateTime?
  lastLoginIp              String?
  failedLoginAttempts      Int                       @default(0)
  lockedUntil              DateTime?
  updatedAt                DateTime                  @updatedAt
  createdAt                DateTime                  @default(now())
  isActive                 Boolean                   @default(true)
  role                     AdminRole                 @default(ADMIN)
  mfaBackupCodes           String[]                  @default([]) @map("mfa_backup_codes")
  mfaEnabled               Boolean                   @default(false) @map("mfa_enabled")
  mfaEnabledAt             DateTime?                 @map("mfa_enabled_at")
  mfaSecret                String?                   @map("mfa_secret")
  mustChangePassword       Boolean                   @default(false) @map("must_change_password")
  passwordChangedAt        DateTime?                 @map("password_changed_at")
  passwordExpiresAt        DateTime?                 @map("password_expires_at")
  sessionVersion           Int                       @default(0) @map("session_version")
  adminPasswordResetTokens AdminPasswordResetToken[]
  adminSessions            AdminSession[]
  auditLogs                AuditLog[]
  magicLinks               MagicLink[]
  oauthAccounts            OAuthAccount[]
  passwordHistory          PasswordHistory[]
  refreshTokens            RefreshToken[]
  securityEvents           SecurityEvent[]

  @@map("admin_users")
}

model AdminPasswordResetToken {
  id          String    @id @default(cuid())
  token       String    @unique
  adminUserId String    @map("admin_user_id")
  expiresAt   DateTime  @map("expires_at")
  used        Boolean   @default(false)
  createdAt   DateTime  @default(now()) @map("created_at")
  adminUser   AdminUser @relation(fields: [adminUserId], references: [id], onDelete: Cascade)

  @@index([token])
  @@index([adminUserId])
  @@index([expiresAt])
  @@map("admin_password_reset_tokens")
}

model RefreshToken {
  id                String        @id @default(uuid())
  token             String        @unique
  userId            String
  expiresAt         DateTime
  createdAt         DateTime      @default(now())
  userAgent         String?
  ipAddress         String?
  isRevoked         Boolean       @default(false)
  revokedAt         DateTime?
  deviceFingerprint String?       @map("device_fingerprint")
  replacedBy        String?       @map("replaced_by")
  revokedReason     String?       @map("revoked_reason")
  sessionId         String?       @map("session_id")
  session           AdminSession? @relation(fields: [sessionId], references: [id])
  user              AdminUser     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([token])
  @@index([userId])
  @@index([expiresAt])
  @@index([sessionId])
  @@map("refresh_tokens")
}

model AdminSession {
  id                String         @id @default(uuid())
  userId            String         @map("user_id")
  ipAddress         String?        @map("ip_address")
  userAgent         String?        @map("user_agent")
  deviceType        String?        @map("device_type")
  browser           String?
  os                String?
  deviceFingerprint String?        @map("device_fingerprint")
  country           String?
  region            String?
  city              String?
  latitude          Float?
  longitude         Float?
  isActive          Boolean        @default(true) @map("is_active")
  lastActivityAt    DateTime       @default(now()) @map("last_activity_at")
  createdAt         DateTime       @default(now()) @map("created_at")
  expiresAt         DateTime       @map("expires_at")
  revokedAt         DateTime?      @map("revoked_at")
  revokedReason     String?        @map("revoked_reason")
  tokenChainId      String?        @map("token_chain_id")
  user              AdminUser      @relation(fields: [userId], references: [id], onDelete: Cascade)
  refreshTokens     RefreshToken[]

  @@index([userId])
  @@index([isActive])
  @@index([lastActivityAt(sort: Desc)])
  @@index([tokenChainId])
  @@map("admin_sessions")
}

model SecurityEvent {
  id          String     @id @default(cuid())
  userId      String?    @map("user_id")
  eventType   String     @map("event_type")
  severity    String     @default("info")
  description String?
  metadata    Json?
  ipAddress   String?    @map("ip_address")
  userAgent   String?    @map("user_agent")
  country     String?
  region      String?
  city        String?
  latitude    Float?
  longitude   Float?
  createdAt   DateTime   @default(now()) @map("created_at")
  user        AdminUser? @relation(fields: [userId], references: [id])

  @@index([userId])
  @@index([eventType])
  @@index([severity])
  @@index([createdAt(sort: Desc)])
  @@index([ipAddress])
  @@map("security_events")
}

model PasswordHistory {
  id           String    @id @default(cuid())
  userId       String    @map("user_id")
  passwordHash String    @map("password_hash")
  createdAt    DateTime  @default(now()) @map("created_at")
  user         AdminUser @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([createdAt(sort: Desc)])
  @@map("password_history")
}

model MagicLink {
  id        String    @id @default(cuid())
  token     String    @unique
  userId    String    @map("user_id")
  email     String
  expiresAt DateTime  @map("expires_at")
  usedAt    DateTime? @map("used_at")
  isUsed    Boolean   @default(false) @map("is_used")
  ipAddress String?   @map("ip_address")
  userAgent String?   @map("user_agent")
  createdAt DateTime  @default(now()) @map("created_at")
  user      AdminUser @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([token])
  @@index([userId])
  @@index([email])
  @@index([expiresAt])
  @@map("magic_links")
}

model OAuthAccount {
  id             String    @id @default(cuid())
  userId         String    @map("user_id")
  provider       String
  providerUserId String    @map("provider_user_id")
  email          String?
  displayName    String?   @map("display_name")
  avatarUrl      String?   @map("avatar_url")
  accessToken    String?   @map("access_token")
  refreshToken   String?   @map("refresh_token")
  tokenExpiresAt DateTime? @map("token_expires_at")
  createdAt      DateTime  @default(now()) @map("created_at")
  updatedAt      DateTime  @updatedAt @map("updated_at")
  user           AdminUser @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([provider, providerUserId])
  @@index([userId])
  @@index([provider])
  @@map("oauth_accounts")
}

model PasswordPolicy {
  id                     String   @id @default(cuid())
  name                   String   @default("default")
  minLength              Int      @default(8) @map("min_length")
  maxLength              Int      @default(128) @map("max_length")
  requireUppercase       Boolean  @default(true) @map("require_uppercase")
  requireLowercase       Boolean  @default(true) @map("require_lowercase")
  requireNumbers         Boolean  @default(true) @map("require_numbers")
  requireSymbols         Boolean  @default(false) @map("require_symbols")
  expirationDays         Int      @default(90) @map("expiration_days")
  historyCount           Int      @default(5) @map("history_count")
  maxFailedAttempts      Int      @default(5) @map("max_failed_attempts")
  lockoutDurationMinutes Int      @default(15) @map("lockout_duration_minutes")
  isActive               Boolean  @default(true) @map("is_active")
  createdAt              DateTime @default(now()) @map("created_at")
  updatedAt              DateTime @updatedAt @map("updated_at")

  @@map("password_policies")
}

model AuditLog {
  id         String     @id @default(cuid())
  action     String
  entityType String     @map("entity_type")
  entityId   String     @map("entity_id")
  changes    Json?
  createdAt  DateTime   @default(now()) @map("created_at")
  userId     String?    @map("user_id")
  ipAddress  String?    @map("ip_address")
  severity   String     @default("info")
  userAgent  String?    @map("user_agent")
  user       AdminUser? @relation(fields: [userId], references: [id])

  @@index([entityType, entityId])
  @@index([userId])
  @@index([createdAt(sort: Desc)])
  @@index([userId, createdAt(sort: Desc)])
  @@index([action])
  @@index([severity])
  @@map("audit_logs")
}

model JwtKey {
  id        String    @id @default(cuid())
  keyId     String    @unique @map("key_id")
  version   Int       @default(1)
  isActive  Boolean   @default(true) @map("is_active")
  isPrimary Boolean   @default(false) @map("is_primary")
  createdAt DateTime  @default(now()) @map("created_at")
  expiresAt DateTime? @map("expires_at")
  rotatedAt DateTime? @map("rotated_at")

  @@index([isActive])
  @@index([isPrimary])
  @@map("jwt_keys")
}

model SyncJob {
  id                  String          @id @default(cuid())
  bandId              String?         @map("band_id")
  jobType             SyncJobType     @map("job_type")
  status              SyncJobStatus   @default(QUEUED)
  videosFound         Int             @default(0) @map("videos_found")
  videosAdded         Int             @default(0) @map("videos_added")
  videosUpdated       Int             @default(0) @map("videos_updated")
  errors              String[]        @default([])
  priority            SyncPriority    @default(MEDIUM)
  estimatedQuotaCost  Int?            @map("estimated_quota_cost")
  actualQuotaCost     Int?            @map("actual_quota_cost")
  quotaApproved       Boolean         @default(false) @map("quota_approved")
  quotaApprovalReason String?         @map("quota_approval_reason")
  startedAt           DateTime?       @map("started_at")
  completedAt         DateTime?       @map("completed_at")
  createdAt           DateTime        @default(now()) @map("created_at")
  errorMessage        String?         @map("error_message")
  maxVideos           Int?            @map("max_videos")
  publishedAfter      DateTime?       @map("published_after")
  publishedBefore     DateTime?       @map("published_before")
  quotaUsed           Int             @default(0) @map("quota_used")
  quotaUsageLogs      QuotaUsageLog[]
  band                Band?           @relation(fields: [bandId], references: [id])

  @@index([bandId])
  @@index([status])
  @@index([priority])
  @@index([priority, status])
  @@index([quotaApproved])
  @@index([createdAt(sort: Desc)])
  @@index([status, createdAt(sort: Desc)])
  @@index([bandId, status])
  @@map("sync_jobs")
}

model QuotaUsageLog {
  id           String   @id @default(cuid())
  operation    String
  cost         Int
  timestamp    DateTime @default(now())
  bandId       String?  @map("band_id")
  bandName     String?  @map("band_name")
  syncJobId    String?  @map("sync_job_id")
  success      Boolean  @default(true)
  cacheHit     Boolean  @default(false) @map("cache_hit")
  errorMessage String?  @map("error_message")
  metadata     Json?
  createdAt    DateTime @default(now()) @map("created_at")
  band         Band?    @relation(fields: [bandId], references: [id])
  syncJob      SyncJob? @relation(fields: [syncJobId], references: [id])

  @@index([timestamp(sort: Desc)])
  @@index([operation])
  @@index([bandId])
  @@index([syncJobId])
  @@index([success])
  @@index([cacheHit])
  @@index([timestamp(sort: Desc), operation])
  @@index([timestamp(sort: Desc), bandId])
  @@map("quota_usage_log")
}

model QuotaDailySummary {
  id                 String   @id @default(cuid())
  date               DateTime @unique @db.Date
  totalUsage         Int      @map("total_usage")
  quotaLimit         Int      @map("quota_limit")
  percentageUsed     Float    @map("percentage_used")
  operationBreakdown Json?    @map("operation_breakdown")
  topConsumers       Json?    @map("top_consumers")
  cacheHitRate       Float?   @map("cache_hit_rate")
  createdAt          DateTime @default(now()) @map("created_at")
  updatedAt          DateTime @updatedAt @map("updated_at")

  @@index([date(sort: Desc)])
  @@index([percentageUsed(sort: Desc)])
  @@map("quota_daily_summary")
}

model QuotaAlert {
  id             String          @id @default(cuid())
  level          QuotaAlertLevel
  message        String
  currentUsage   Int             @map("current_usage")
  timestamp      DateTime        @default(now())
  acknowledged   Boolean         @default(false)
  acknowledgedAt DateTime?       @map("acknowledged_at")
  acknowledgedBy String?         @map("acknowledged_by")
  createdAt      DateTime        @default(now()) @map("created_at")

  @@index([timestamp(sort: Desc)])
  @@index([level])
  @@index([acknowledged])
  @@index([level, acknowledged])
  @@map("quota_alerts")
}

model PopularSearch {
  id           String   @id @default(cuid())
  query        String   @unique
  searchCount  Int      @default(1)
  lastSearched DateTime @default(now())
  createdAt    DateTime @default(now())

  @@index([searchCount])
  @@index([lastSearched])
  @@map("popular_searches")
}

model ApiKey {
  id                   String    @id @default(cuid())
  key                  String    @unique
  name                 String
  description          String?
  createdAt            DateTime  @default(now()) @map("created_at")
  expiresAt            DateTime? @map("expires_at")
  isActive             Boolean   @default(true) @map("is_active")
  lastUsedAt           DateTime? @map("last_used_at")
  updatedAt            DateTime  @updatedAt @map("updated_at")
  lastRotatedAt        DateTime? @map("last_rotated_at")
  rotationWarningsSent Int       @default(0) @map("rotation_warnings_sent")
  usageCount           Int       @default(0) @map("usage_count")

  @@index([key])
  @@index([isActive])
  @@index([expiresAt])
  @@map("api_keys")
}

model User {
  id                      String                   @id @default(cuid())
  email                   String                   @unique
  passwordHash            String                   @map("password_hash")
  name                    String
  avatar                  String?
  bio                     String?
  emailVerified           Boolean                  @default(false) @map("email_verified")
  preferences             Json                     @default("{}")
  lastSeenAt              DateTime?                @map("last_seen_at")
  createdAt               DateTime                 @default(now()) @map("created_at")
  updatedAt               DateTime                 @updatedAt @map("updated_at")
  emailVerificationTokens EmailVerificationToken[]
  favoriteBands           FavoriteBand[]
  favoriteVideos          FavoriteVideo[]
  notificationPreferences NotificationPreference?
  notifications           Notification[]
  passwordResetTokens     PasswordResetToken[]
  sessions                UserSession[]
  watchLater              WatchLater[]

  @@index([email])
  @@map("users")
}

model EmailVerificationToken {
  id        String   @id @default(cuid())
  token     String   @unique
  userId    String   @map("user_id")
  expiresAt DateTime @map("expires_at")
  createdAt DateTime @default(now()) @map("created_at")
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([token])
  @@index([userId])
  @@map("email_verification_tokens")
}

model PasswordResetToken {
  id        String   @id @default(cuid())
  token     String   @unique
  userId    String   @map("user_id")
  expiresAt DateTime @map("expires_at")
  used      Boolean  @default(false)
  createdAt DateTime @default(now()) @map("created_at")
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([token])
  @@index([userId])
  @@map("password_reset_tokens")
}

model UserSession {
  id           String   @id @default(cuid())
  userId       String   @map("user_id")
  token        String   @unique
  deviceType   String?  @map("device_type")
  browser      String?
  ipAddress    String?  @map("ip_address")
  lastActiveAt DateTime @default(now()) @map("last_active_at")
  createdAt    DateTime @default(now()) @map("created_at")
  expiresAt    DateTime @map("expires_at")
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([token])
  @@map("user_sessions")
}

model SearchLog {
  id           String   @id @default(cuid())
  query        String
  resultsCount Int      @map("results_count")
  filters      Json?
  userId       String?  @map("user_id")
  sessionId    String?  @map("session_id")
  createdAt    DateTime @default(now()) @map("created_at")

  @@index([query])
  @@index([createdAt(sort: Desc)])
  @@index([userId])
  @@map("search_logs")
}

model FeaturedBandClick {
  id        String   @id @default(cuid())
  bandId    String   @map("band_id")
  clickedAt DateTime @default(now()) @map("clicked_at")
  sessionId String?  @map("session_id")
  band      Band     @relation(fields: [bandId], references: [id], onDelete: Cascade)

  @@index([bandId])
  @@index([clickedAt])
  @@map("featured_band_clicks")
}

model FavoriteVideo {
  id        String   @id @default(cuid())
  userId    String   @map("user_id")
  videoId   String   @map("video_id")
  notes     String?
  createdAt DateTime @default(now()) @map("created_at")
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  video     Video    @relation(fields: [videoId], references: [id], onDelete: Cascade)

  @@unique([userId, videoId])
  @@index([userId])
  @@index([videoId])
  @@map("favorite_videos")
}

model FavoriteBand {
  id                   String   @id @default(cuid())
  userId               String   @map("user_id")
  bandId               String   @map("band_id")
  notificationsEnabled Boolean  @default(true) @map("notifications_enabled")
  createdAt            DateTime @default(now()) @map("created_at")
  band                 Band     @relation(fields: [bandId], references: [id], onDelete: Cascade)
  user                 User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, bandId])
  @@index([userId])
  @@index([bandId])
  @@map("favorite_bands")
}

model WatchLater {
  id        String    @id @default(cuid())
  userId    String    @map("user_id")
  videoId   String    @map("video_id")
  watched   Boolean   @default(false)
  watchedAt DateTime? @map("watched_at")
  createdAt DateTime  @default(now()) @map("created_at")
  updatedAt DateTime  @updatedAt @map("updated_at")
  user      User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  video     Video     @relation(fields: [videoId], references: [id], onDelete: Cascade)

  @@unique([userId, videoId])
  @@index([userId])
  @@index([videoId])
  @@map("watch_later")
}

model Notification {
  id        String   @id @default(cuid())
  userId    String   @map("user_id")
  type      String
  title     String
  message   String
  data      Json?
  read      Boolean  @default(false)
  createdAt DateTime @default(now()) @map("created_at")
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId, read])
  @@index([createdAt])
  @@map("notifications")
}

model NotificationPreference {
  id                 String   @id @default(cuid())
  userId             String   @unique @map("user_id")
  emailNewVideo      Boolean  @default(true) @map("email_new_video")
  emailUpcoming      Boolean  @default(true) @map("email_upcoming")
  emailWeeklyDigest  Boolean  @default(true) @map("email_weekly_digest")
  inAppNotifications Boolean  @default(true) @map("in_app_notifications")
  createdAt          DateTime @default(now()) @map("created_at")
  updatedAt          DateTime @updatedAt @map("updated_at")
  user               User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("notification_preferences")
}

enum SyncStatus {
  PENDING
  IN_PROGRESS
  COMPLETED
  FAILED
}

enum AdminRole {
  SUPER_ADMIN
  ADMIN
  MODERATOR
}

enum SyncJobType {
  FULL_SYNC
  INCREMENTAL_SYNC
  SINGLE_VIDEO
  CHANNEL_SYNC
}

enum SyncJobStatus {
  QUEUED
  IN_PROGRESS
  COMPLETED
  FAILED
}

enum EventType {
  BAYOU_CLASSIC
  SWAC_CHAMPIONSHIP
  HOMECOMING
  BATTLE_OF_THE_BANDS
  FOOTBALL_GAME
  PARADE
  CONCERT
  COMPETITION
  EXHIBITION
  OTHER
}

enum SecurityEventType {
  LOGIN_SUCCESS
  LOGIN_FAILED
  LOGOUT
  REFRESH_TOKEN_USED
  REFRESH_REUSE_DETECTED
  MFA_ENABLED
  MFA_DISABLED
  MFA_VERIFIED
  MFA_FAILED
  PASSWORD_CHANGED
  PASSWORD_RESET_REQUESTED
  PASSWORD_RESET_COMPLETED
  MAGIC_LINK_CREATED
  MAGIC_LINK_USED
  OAUTH_LINKED
  OAUTH_UNLINKED
  SESSION_CREATED
  SESSION_REVOKED
  ACCOUNT_LOCKED
  ACCOUNT_UNLOCKED
  SUSPICIOUS_LOGIN
}

enum OAuthProvider {
  GOOGLE
  MICROSOFT
}

enum QuotaAlertLevel {
  INFO
  WARNING
  CRITICAL
  DEPLETED
}

enum SyncPriority {
  CRITICAL
  HIGH
  MEDIUM
  LOW
}
